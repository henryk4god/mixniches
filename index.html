<div id="product-ideas-widget">
  <style>
    :root {
      --primary-color: #6c5ce7;
      --secondary-color: #a29bfe;
      --bg-color: #f9f9f9;
      --card-bg: #ffffff;
      --text-color: #333333;
      --accent-color: #00cec9;
      --error-color: #d63031;
      --success-color: #00b894;
      --product-name-color: #6c5ce7;
      --section-title-color: #00b894;
      --border-radius: 12px;
      --box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    #product-ideas-widget {
      font-family: 'Poppins', sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
      background: var(--bg-color);
      border-radius: var(--border-radius);
      color: var(--text-color);
    }

    .widget-header {
      text-align: center;
      margin-bottom: 2rem;
      animation: fadeIn 0.8s ease;
    }

    .widget-title {
      font-size: 1.8rem;
      margin-bottom: 0.5rem;
      color: var(--primary-color);
      font-weight: 600;
    }

    .widget-subtitle {
      font-size: 1rem;
      color: var(--text-color);
      opacity: 0.8;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .input-field {
      width: 100%;
      padding: 0.8rem 1rem;
      border: 2px solid #e0e0e0;
      border-radius: var(--border-radius);
      font-family: 'Poppins', sans-serif;
      font-size: 0.9rem;
      transition: var(--transition);
    }

    .input-field:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.2);
    }

    .btn {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      font-size: 1rem;
      font-weight: 500;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: var(--transition);
      font-family: 'Poppins', sans-serif;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn:hover {
      background: var(--secondary-color);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(108, 92, 231, 0.3);
    }

    .btn:disabled {
      background: #cccccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn-copy {
      background: var(--accent-color);
      margin-left: 1rem;
    }

    .btn-copy:hover {
      background: #00a8a8;
    }

    .results-container {
      margin-top: 2rem;
      display: none;
      animation: fadeIn 0.8s ease;
    }

    .results-title {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--primary-color);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .product-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: var(--box-shadow);
      transition: var(--transition);
    }

    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
    }

    .product-name {
      font-weight: 700;
      color: var(--product-name-color);
      margin-bottom: 1rem;
      font-size: 1.2rem;
      line-height: 1.4;
    }

    .product-type {
      font-weight: 600;
      color: var(--section-title-color);
      margin-bottom: 0.5rem;
    }

    .product-description {
      color: var(--text-color);
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .product-features, .product-monetization {
      margin: 1rem 0;
    }

    .product-features h4, .product-monetization h4 {
      color: var(--section-title-color);
      margin-bottom: 0.5rem;
      font-size: 1rem;
    }

    .product-features-list {
      color: var(--text-color);
      line-height: 1.6;
      padding-left: 1rem;
    }

    .loading {
      display: none;
      text-align: center;
      margin: 2rem 0;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(108, 92, 231, 0.1);
      border-radius: 50%;
      border-top-color: var(--primary-color);
      animation: spin 1s ease-in-out infinite;
      margin: 0 auto 1rem;
    }

    .error-message {
      color: var(--error-color);
      text-align: center;
      margin: 1rem 0;
      display: none;
    }

    .success-message {
      color: var(--success-color);
      text-align: center;
      margin: 1rem 0;
      display: none;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @media (max-width: 768px) {
      #product-ideas-widget {
        padding: 1.5rem;
      }
      
      .widget-title {
        font-size: 1.5rem;
      }
      
      .btn {
        width: 100%;
      }
      
      .btn-copy {
        margin-left: 0;
        margin-top: 1rem;
      }
      
      .results-title {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }
    }
  </style>

  <div class="widget-header">
    <h1 class="widget-title">Get Unique Product Ideas</h1>
    <p class="widget-subtitle">Mix your expertise with trending questions to generate innovative digital products</p>
  </div>

  <div class="input-group">
    <input type="text" id="niche-input" class="input-field" placeholder="Enter your specialist area (e.g., fitness coaching, graphic design)">
    <input type="text" id="questions-input" class="input-field" placeholder="Enter trending questions from different niches (e.g., How to save time?, How to stay motivated?)">
  </div>

  <button id="generate-btn" class="btn">
    <span>Get Unique Product Ideas</span>
  </button>

  <div class="loading">
    <div class="spinner"></div>
    <p>Generating unique product ideas...</p>
  </div>

  <div class="error-message"></div>
  <div class="success-message"></div>

  <div class="results-container">
    <h2 class="results-title">
      <span>Your Unique Product Ideas</span>
      <button id="copy-all-btn" class="btn btn-copy">Copy All</button>
    </h2>
    <div id="product-results"></div>
  </div>

  // ... (The HTML and CSS remain the same above this script block)

Â  <script>
Â  Â  document.addEventListener('DOMContentLoaded', function() {
Â  Â  Â  const generateBtn = document.getElementById('generate-btn');
Â  Â  Â  const nicheInput = document.getElementById('niche-input');
Â  Â  Â  const questionsInput = document.getElementById('questions-input');
Â  Â  Â  const loadingElement = document.querySelector('.loading');
Â  Â  Â  const resultsContainer = document.querySelector('.results-container');
Â  Â  Â  const productResults = document.getElementById('product-results');
Â  Â  Â  const errorMessage = document.querySelector('.error-message');
Â  Â  Â  const successMessage = document.querySelector('.success-message');
Â  Â  Â  const copyAllBtn = document.getElementById('copy-all-btn');

      // ðŸ”´ IMPORTANT: REPLACE THIS WITH YOUR DEPLOYED GOOGLE APPS SCRIPT URL
      const API_ENDPOINT = 'https://script.google.com/macros/s/AKfycbwCOO8AWUByaL4tDWBAu7EwHH14vNe3nPW2dN2hTNL9J9Y4TRkyiwC2mrG0Nll7fNwE4Q/exec'; 

Â  Â  Â  generateBtn.addEventListener('click', generateProductIdeas);
Â  Â  Â  copyAllBtn.addEventListener('click', copyAllResults);

Â  Â  Â  async function generateProductIdeas() {
Â  Â  Â  Â  const niche = nicheInput.value.trim();
Â  Â  Â  Â  const questions = questionsInput.value.trim();

Â  Â  Â  Â  if (!niche || !questions) {
Â  Â  Â  Â  Â  showError('Please fill in both fields');
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Clear previous results and errors
Â  Â  Â  Â  productResults.innerHTML = '';
Â  Â  Â  Â  hideError();
Â  Â  Â  Â  hideSuccess();

Â  Â  Â  Â  // Show loading state
Â  Â  Â  Â  generateBtn.disabled = true;
Â  Â  Â  Â  loadingElement.style.display = 'block';
Â  Â  Â  Â  resultsContainer.style.display = 'none';

Â  Â  Â  Â  try {
          // 1. Prepare data to send to the Apps Script backend
          const requestBody = {
              niche: niche,
              questions: questions
          };

          // 2. Fetch call is now directed to the Apps Script endpoint
Â  Â  Â  Â  Â  const response = await fetch(API_ENDPOINT, {
Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  Â  'Content-Type': 'application/json',
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  body: JSON.stringify(requestBody) // Send niche and questions in the body
Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  throw new Error(`API request failed with status ${response.status}`);
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  const data = await response.json();
          
          // Check for errors returned in the JSON payload (from our Apps Script backend)
          if (data.error) {
              throw new Error(data.error);
          }
          
Â  Â  Â  Â  Â  const content = data.choices[0]?.message?.content;

Â  Â  Â  Â  Â  if (!content) {
Â  Â  Â  Â  Â  Â  throw new Error('No content received from API');
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  // Process and display results
Â  Â  Â  Â  Â  displayResults(content);
Â  Â  Â  Â  Â  showSuccess('Product ideas generated successfully!');
Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  console.error('Error:', error);
Â  Â  Â  Â  Â  showError('Failed to generate product ideas. Check the console and Apps Script logs.');
Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  loadingElement.style.display = 'none';
Â  Â  Â  Â  Â  generateBtn.disabled = false;
Â  Â  Â  Â  }
Â  Â  Â  }
      // ... (The rest of the functions like displayResults, copyAllResults, etc., remain the same)
      
      
Â  Â  Â  function displayResults(content) {
Â  Â  Â  Â  // Split content by numbered items
Â  Â  Â  Â  const products = content.split(/\d+\./).filter(item => item.trim());
Â  Â  Â  Â Â 
Â  Â  Â  Â  products.forEach((product, index) => {
Â  Â  Â  Â  Â  if (!product.trim()) return;
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Create card container
Â  Â  Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  Â  Â  card.className = 'product-card';
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Parse product details
Â  Â  Â  Â  Â  const nameMatch = product.match(/\*\*([^*]+)\*\*/);
Â  Â  Â  Â  Â  const typeMatch = product.match(/\*\*Type:\*\*(.+?)(?=\n\*\*|$)/s);
Â  Â  Â  Â  Â  const descMatch = product.match(/\*\*Description:\*\*(.+?)(?=\n\*\*|$)/s);
Â  Â  Â  Â  Â  const featuresMatch = product.match(/\*\*Features:\*\*(.+?)(?=\n\*\*|$)/s);
Â  Â  Â  Â  Â  const monetizationMatch = product.match(/\*\*Monetization:\*\*(.+?)(?=\n\d+\.|$)/s);
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Build card content
Â  Â  Â  Â  Â  let cardContent = '';
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Add product name/number
Â  Â  Â  Â  Â  if (nameMatch) {
Â  Â  Â  Â  Â  Â  cardContent += `<div class="product-name">${index+1}. <strong>${nameMatch[1].trim()}</strong></div>`;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Add type
Â  Â  Â  Â  Â  if (typeMatch) {
Â  Â  Â  Â  Â  Â  cardContent += `<div class="product-type"><strong>Type:</strong> ${typeMatch[1].trim()}</div>`;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Add description
Â  Â  Â  Â  Â  if (descMatch) {
Â  Â  Â  Â  Â  Â  cardContent += `<div class="product-description"><strong>Description:</strong> ${descMatch[1].trim()}</div>`;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Add features
Â  Â  Â  Â  Â  if (featuresMatch) {
Â  Â  Â  Â  Â  Â  const featuresList = featuresMatch[1]
Â  Â  Â  Â  Â  Â  Â  .split('\n- ').filter(item => item.trim())
Â  Â  Â  Â  Â  Â  Â  .map(item => `<li>${item.trim()}</li>`).join('');
Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  cardContent += `
Â  Â  Â  Â  Â  Â  Â  <div class="product-features">
Â  Â  Â  Â  Â  Â  Â  Â  <h4>Features:</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <ul class="product-features-list">${featuresList}</ul>
Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Add monetization
Â  Â  Â  Â  Â  if (monetizationMatch) {
Â  Â  Â  Â  Â  Â  cardContent += `
Â  Â  Â  Â  Â  Â  Â  <div class="product-monetization">
Â  Â  Â  Â  Â  Â  Â  Â  <h4>Monetization:</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <p>${monetizationMatch[1].trim()}</p>
Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  card.innerHTML = cardContent;
Â  Â  Â  Â  Â  productResults.appendChild(card);
Â  Â  Â  Â  });

Â  Â  Â  Â  resultsContainer.style.display = 'block';
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Scroll to results
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  resultsContainer.scrollIntoView({ behavior: 'smooth' });
Â  Â  Â  Â  }, 300);
Â  Â  Â  }

Â  Â  Â  function copyAllResults() {
Â  Â  Â  Â  const textToCopy = Array.from(document.querySelectorAll('.product-card'))
Â  Â  Â  Â  Â  .map(card => card.textContent)
Â  Â  Â  Â  Â  .join('\n\n');
Â  Â  Â  Â Â 
Â  Â  Â  Â  navigator.clipboard.writeText(textToCopy)
Â  Â  Â  Â  Â  .then(() => {
Â  Â  Â  Â  Â  Â  copyAllBtn.textContent = 'Copied!';
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  copyAllBtn.textContent = 'Copy All';
Â  Â  Â  Â  Â  Â  }, 2000);
Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  .catch(err => {
Â  Â  Â  Â  Â  Â  console.error('Failed to copy: ', err);
Â  Â  Â  Â  Â  });
Â  Â  Â  }

Â  Â  Â  function showError(message) {
Â  Â  Â  Â  errorMessage.textContent = message;
Â  Â  Â  Â  errorMessage.style.display = 'block';
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  errorMessage.style.animation = 'fadeIn 0.3s ease';
Â  Â  Â  Â  }, 10);
Â  Â  Â  }

Â  Â  Â  function hideError() {
Â  Â  Â  Â  errorMessage.style.display = 'none';
Â  Â  Â  }

Â  Â  Â  function showSuccess(message) {
Â  Â  Â  Â  successMessage.textContent = message;
Â  Â  Â  Â  successMessage.style.display = 'block';
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  successMessage.style.animation = 'fadeIn 0.3s ease';
Â  Â  Â  Â  }, 10);
Â  Â  Â  Â Â 
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  successMessage.style.animation = 'fadeOut 0.3s ease';
Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  successMessage.style.display = 'none';
Â  Â  Â  Â  Â  }, 300);
Â  Â  Â  Â  }, 3000);
Â  Â  Â  }

Â  Â  Â  function hideSuccess() {
Â  Â  Â  Â  successMessage.style.display = 'none';
Â  Â  Â  }
Â  Â  });
Â  </script>
</div>
</div>
